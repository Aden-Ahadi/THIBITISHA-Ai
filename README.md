# Telegram AI Image Detection Bot 🤖🔍

A Telegram bot that analyzes images to detect whether they were generated by AI or are real photographs using machine learning models from Hugging Face.

## Features ✨

- **AI Image Detection**: Analyzes uploaded images and provides probability scores
- **Multiple Model Support**: Fallback system with multiple AI detection models
- **Real-time Analysis**: Instant results with confidence scores and detailed breakdowns
- **User-friendly Interface**: Clean, emoji-rich responses with easy-to-understand verdicts
- **Robust Error Handling**: Network timeouts, connection retries, and graceful failure handling
- **Cross-platform**: Works on Windows, macOS, and Linux

## Supported Image Formats 📸

- **Primary**: JPEG/JPG, PNG, WebP
- **Additional**: GIF (static), BMP, TIFF
- **File Size**: Up to 20MB (Telegram limit)
- **Resolution**: Auto-resized to 1024px max for processing

## Installation 🚀

### Prerequisites
- Python 3.8 or higher
- Internet connection
- Telegram account

### 1. Clone/Download the Repository
```bash
git clone <repository-url>
cd telegram-ai-detection-bot
```

### 2. Install Dependencies
```bash
pip install python-telegram-bot transformers torch torchvision pillow requests
```

### 3. Create a Telegram Bot
1. Message [@BotFather](https://t.me/botfather) on Telegram
2. Send `/newbot` and follow the instructions
3. Choose a name and username for your bot
4. Save the bot token (looks like `123456789:ABCdefGHI...`)

### 4. Set Up Your Bot Token

**Option A: Environment Variable (Recommended)**
```bash
# Windows (Command Prompt)
set TELEGRAM_TOKEN=your_bot_token_here

# Windows (PowerShell)
$env:TELEGRAM_TOKEN="your_bot_token_here"

# Mac/Linux
export TELEGRAM_TOKEN="your_bot_token_here"
```

**Option B: Direct Code Modification**
Edit the bot file and replace:
```python
TOKEN = os.getenv('TELEGRAM_TOKEN')
```
with:
```python
TOKEN = "your_bot_token_here"
```

## Usage 🎯

### Start the Bot
```bash
python clean_ai_bot.py
```

You should see:
```
✅ Successfully loaded model: Organiza/sdxl-detector
🚀 Starting AI Detection Bot...
✅ Bot handlers registered!
Press Ctrl+C to stop
```

### Telegram Commands

- `/start` - Welcome message and bot introduction
- `/info` - Detailed information about the bot and its capabilities
- `/status` - Check bot and model status
- **Send an image** - Get AI detection analysis

### Example Results

**Real Photo Detection:**
```
🟢 AI Detection Results

Verdict: ✅ Very Likely Real Photo
AI Probability: 15.3%
Confidence: High

📊 Breakdown:
- Real Photo: 84.7%
- AI-Generated: 15.3%

🔧 Model: Organiza/sdxl-detector
🚀 Powered by Hugging Face
```

**AI-Generated Image Detection:**
```
🔴 AI Detection Results

Verdict: ⚠️ Likely AI-Generated
AI Probability: 87.2%
Confidence: High

📊 Breakdown:
- Real Photo: 12.8%
- AI-Generated: 87.2%

🔧 Model: Organiza/sdxl-detector
🚀 Powered by Hugging Face
```

## Models Used 🧠

The bot uses a fallback system with multiple models:

1. **Primary**: `umm-maybe/AI-image-detector` - Lightweight, general-purpose
2. **Fallback**: `Organiza/sdxl-detector` - Specialized for SDXL-generated images
3. **Alternative**: `saltacc/anime-ai-detect` - Specialized for anime/art detection

## Troubleshooting 🔧

### Common Issues

**"Event loop is closed" Error**
- Stop the bot (Ctrl+C) and restart
- This happens with auto-restart loops; manual restart is more reliable

**SSL/Connection Timeouts**
- Try using a VPN
- Switch to mobile hotspot
- Check if Telegram is blocked on your network
- Corporate/school networks often block Telegram

**Model Loading Failures**
- Ensure stable internet connection
- Models are downloaded automatically on first run
- Large models may take time to download

**Bot Not Responding**
- Verify bot token is correct
- Check that you've started a conversation with the bot on Telegram
- Send `/start` command first

### Test Connection
```python
import requests
TOKEN = "your_bot_token_here"
response = requests.get(f"https://api.telegram.org/bot{TOKEN}/getMe")
print(response.json())
```

## Technical Details ⚙️

### Architecture
- **Framework**: python-telegram-bot (async)
- **ML Library**: Transformers (Hugging Face)
- **Image Processing**: PIL (Pillow)
- **Model Backend**: PyTorch (CPU optimized)

### Performance
- **Processing Time**: 2-10 seconds per image
- **Memory Usage**: ~1-2GB RAM during processing
- **CPU Usage**: Optimized for CPU inference
- **Concurrent Users**: Handles multiple users simultaneously

### Security Features
- Input validation and sanitization
- Temporary file cleanup
- Error logging without sensitive data exposure
- Network timeout protection

## Development 👩‍💻

### Project Structure
```
├── clean_ai_bot.py          # Main bot application
├── requirements.txt         # Python dependencies
├── README.md               # This file
└── logs/                   # Bot logs (created automatically)
```

### Adding New Models
To add support for additional AI detection models:

1. Add model name to the `models_to_try` list
2. Ensure model outputs binary classification probabilities
3. Test with various image types

### Customization
- Modify response messages in the `format_ai_detection_result()` function
- Adjust confidence thresholds in the detection logic
- Add support for additional image formats

## Contributing 🤝

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## License 📄

This project is open source. Please check the LICENSE file for details.

## Disclaimer ⚠️

- AI detection is not 100% accurate
- Results should be used as guidance, not definitive proof
- Model performance may vary with different types of AI-generated content
- Keep your bot token secure and never share it publicly

## Support 💬

If you encounter issues:

1. Check the troubleshooting section above
2. Review the console logs for error messages
3. Ensure your network allows connections to Telegram and Hugging Face
4. Verify your bot token is correct and active

---

**Happy AI Detecting! 🚀**
